# AZ-whiteness test

This repository contains the reference implementation of _AZ-whiteness test_ as described in the paper:   

Daniele Zambon, Cesare Alippi. [AZ-whiteness test: a test for uncorrelated noise on spatio-temporal graphs.](https://arxiv.org/abs/2204.11135) 2022.
```
@article{zambon2022az,
  doi={10.48550/ARXIV.2204.11135},
  url={https://arxiv.org/abs/2204.11135},
  author={Zambon, Daniele and Alippi, Cesare},
  keywords={Machine Learning (stat.ML), Machine Learning (cs.LG), FOS: Computer and information sciences, FOS: Computer and information sciences},
  title={AZ-whiteness test: a test for uncorrelated noise on spatio-temporal graphs},
  publisher={arXiv},
  year={2022},
  copyright={arXiv.org perpetual, non-exclusive license},
}
```

## Structure of the repository 

The structure of the repository is the following:

- `graph_sign_test.py` implements the AZ-test and some utilities to analyze the prediction residuals.
- `triangular_tricom_graph.py` implements a family of graphs, and exposes plotting utilities.
- `synthetic_residuals.py` implements several targeted synthetic tests on correlated graph signals.
- `graph_polynomial_var.py` implements the GPVAR model and provides a dataset class usable in [TorchSpatiotemporal](https://github.com/TorchSpatiotemporal/tsl) and torch nn model.
- `tsl_experiments.py` extends the [traffic forecasting example](https://github.com/TorchSpatiotemporal/tsl/blob/main/examples/prediction/run_traffic.py) in TorchSpatiotemporal adding GPVAR model and data.


## Experiments and figures of the paper

The experiments of the arXiv version of the paper are run with the following commands.

- Figure 3 is generated by calling `main("sparse-full")` in `synthetic_residual.py`.
- Figure 4 is generated by calling `main("viz")` in `synthetic_residual.py`.
- Figure 5 is generated by calling `main("power", disable_warning=True)` in `synthetic_residual.py`.
- Figure 6 is generated from script `tsl_experiments.py` while running an experiment with `--dataset-name gpvar`.  
- Tables 2, 3 and 4 are obtained from bash script `red_button.sh` that calls `tsl_experiments.py`. 

The generated GPVAR dataset will be stored in folder `data`, 
figures of `synthetic_residuals.py` are stored in folder `results`,
and results of `tsl_experiments.py` are stored in folder `log`.

